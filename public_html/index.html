<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body id="all">
        <img src="img/black.png" id="negre" style="display: none;">
        <!--<canvas id="espai" width="550" height="550"> </canvas>-->
    </body>
    <script>

        var Joc = {
            espai: 0,
            estat: 0,
            puntuacio: 0,
            puntuacioMax: 0,
            pecaVigent: 0,
            seguentPeca: 0,
            nombreDeVegades: new Array(),
            interval: 0,
            nivell: 0,
            inicialitzarJoc: function ()
            {
                this.espai = [
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                ];
                this.nombreDeVegades["i"] = 0;
                this.nombreDeVegades["j"] = 0;
                this.nombreDeVegades["l"] = 0;
                this.nombreDeVegades["o"] = 0;
                this.nombreDeVegades["s"] = 0;
                this.nombreDeVegades["t"] = 0;
                this.nombreDeVegades["z"] = 0;
                this.nivell = 1;
            },
            calcularSeguentPeca: function () {
                //random todo   
            },
            teclatUsuari: function (e) {
                //todo input 
                if (e.keyCode === 40) {//amunt
                    console.log("abaix");
                } else if (e.keyCode === 38) {//abaix
                    console.log("amunt");
                } else if (e.keyCode === 37) {//esquerra
                } else if (e.keyCode === 39) {//dreta
                }
            },
            intervalJoc: function () {
                //todo setinterval
            },
            pinta: function () {
                document.write("Nivell: " + this.nivell + "<br>");
                document.write("Puntuació Màxima: " + this.puntuacioMax);
                document.write("<br>Puntuació Actual: " + this.puntuacio + "<br><br>");


                for (var i = 0; i < this.espai.length; i++) {
                    for (var j = 0; j < this.espai[i].length; j++) {
                        document.write(this.espai[i][j]);
                    }
                    document.write("<br>");
                }
            }
        };

        var Peça = function (forma, color, x, y) {
            this.forma = forma;
            this.color = color;
            this.x = x;
            this.y = y;
        };
        function GeneraPecaAleatoria() {
            var peces = [
                [[[0, 0, 0, 0], [0, 1, 1, 0], [0, 1, 1, 0], [0, 0, 0, 0]], "groc"],
                [[[0, 1, 0, 0], [0, 1, 0, 0], [0, 1, 0, 0], [0, 1, 0, 0]], "lila"],
                [[[0, 0, 0, 0], [0, 1, 1, 0], [1, 1, 0, 0], [0, 0, 0, 0]], "verd"],
                [[[0, 0, 0, 0], [0, 1, 1, 0], [0, 0, 1, 1], [0, 0, 0, 0]], "roig"],
                [[[0, 1, 0, 0], [0, 1, 0, 0], [0, 1, 1, 0], [0, 0, 0, 0]], "blau"],
                [[[0, 1, 1, 0], [0, 1, 0, 0], [0, 1, 0, 0], [0, 0, 0, 0]], "taronga"],
                [[[0, 0, 0, 0], [1, 1, 1, 0], [0, 1, 0, 0], [0, 0, 0, 0]], "morat"]];
            var numeroAleatori = Math.round(Math.random() * 6);
            return peces[numeroAleatori];
        }

        Peça.prototype.moureD = function () {
            if ((x - 1) > 0) {
                x--;
                return true;
            } else {
                return false;
            }
        };

        Peça.prototype.moureEsquerra = function () {
            if ((x + 1) < 14) {
                x++;
                return true;
            } else {
                return false;
            }
        };

        Peça.prototype.moureAbaix = function () {
            if (y - 1 > 0) {
                y--;
                return true;
            } else {
                return false;
            }
        };

        Peça.prototype.rotarDreta = function () {
            var formaNova = new Array();
            for (var i = 0; i < this.forma.length; i++) {
                formaNova[i] = new Array();
                for (var j = 0; j < this.forma[i].length; j++) {
                    formaNova[i][j] = this.forma[this.forma[i].length - 1 - j][i];
                }
            }
            this.forma = formaNova;
        };
        Peça.prototype.rotarEsquerra = function () {
            this.rotarDreta();
            this.rotarDreta();
            this.rotarDreta();
        };
        Peça.prototype.pintar = function ()
        {
            var resultat = "<table border='1'>";
            for (var i = 0; i < this.forma.length; i++)
            {
                resultat = resultat + "<tr>";
                for (var j = 0; j < this.forma[i].length; j++)
                {
                    resultat = resultat + "<td>";
                    if (this.forma[i][j] === 1) {
                        resultat = resultat + "X";
                    } else {
                        resultat = resultat + "-";
                    }
                    resultat = resultat + "</td>";
                }
                resultat = resultat + "</tr>";
            }
            resultat = resultat + "</table>";
            return resultat;
        };
        Peça.prototype.getForma = function () {
            return this.forma;
        };


        Joc.inicialitzarJoc();
        Joc.pinta();
        var pa = GeneraPecaAleatoria();
        var p = new Peça(pa[0], pa[1]);
        document.write(p.pintar());

        p.rotarEsquerra();
        document.write(p.pintar());
        
    </script>
</html>
